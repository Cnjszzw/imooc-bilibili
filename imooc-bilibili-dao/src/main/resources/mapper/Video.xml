<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD MAPPER 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace是要和实体类对应的接口一模一样的 -->
<mapper namespace="com.imooc.bilibili.dao.VideoDao">

    <insert id="addVideos" useGeneratedKeys="true" keyProperty="id">
        insert into t_video
            (userId,
             url,
             thumbnail,
             title,
             type,
             duration,
             area,
             description,
             createTime,
             updateTime)
        values
            (#{userId},
             #{url},
             #{thumbnail},
             #{title},
             #{type},
             #{duration},
             #{area},
             #{description},
             #{createTime},
             #{updateTime})
    </insert>
    <insert id="batchAddVideoTags">
        insert into t_video_tag(
            videoId,
            tagId,
            createTime
        )values
         <foreach collection="tagList" item="videoTag" separator=",">
             (#{videoTag.videoId},#{videoTag.tagId},#{videoTag.createTime})
         </foreach>
    </insert>
    <select id="pageListVideos" resultType="com.imooc.bilibili.domain.Video" >
        select * from t_video
        <where>
            <if test="area != null and area != ''">
                and area = #{area}
            </if>
        </where>
        limit #{start},#{limit}
    </select>
    <select id="queryVideosTotalNum" resultType="java.lang.Integer">
        select count(*) from t_video
        <where>
            <if test="area != null and area != ''">
                and area = #{area}
            </if>
        </where>
    </select>
    <select id="queryVideoTagsByVideoId" resultType="com.imooc.bilibili.domain.VideoTag">
        select * from t_video_tag where videoId = #{videoId}
    </select>
</mapper>